const paragraphs = [
  "L'établissement d'objectifs réalistes est essentiel pour un développeur. Il faut définir des objectifs spécifiques, mesurables et réalisables permettant de progresser dans votre carrière. Que ce soit l'apprentissage d'un nouveau langage de programmation, l'acquisition de compétences en gestion de projet ou la participation à des projets d'envergure, l'important est de vous fixer des objectifs qui vous motivent et vous guident vers le succès. Ceux-ci vous serviront à tracer votre chemin vers une carrière pleine de succès en tant que développeur informatique.",
  "Pour un développeur informatique, il est primordial de se fixer des objectifs réalistes. Identifiez les compétences que vous souhaitez développer, les projets auxquels vous voulez contribuer ou les certifications que vous voulez obtenir. En définissant des objectifs réalisables et en élaborant un plan d'action concret, vous serez en mesure de progresser de manière significative dans votre carrière de développeur informatique. Les objectifs réalistes vous fournissent une direction claire et une motivation pour atteindre vos aspirations professionnelles.",

  "Sortir de votre zone de confort est essentielle pour votre développement en tant que développeur informatique. Expérimentez de nouvelles technologies, ouvrez vous à des professionnels plus expérimentés, participez à des projets innovants ou relevez des défis techniques complexes. En sortant de cette zone qui nous est confortable, vous améliorez vos compétences et élargissez ainsi vos horizons professionnels. Ne craignez pas l'échec, c'est souvent dans les moments de prise de risque que se trouvent les opportunités les plus enrichissantes.",

  "S'entourer de soutien est essentiel pour un développeur informatique. Privilégiez des collègues bienveillants et des mentors expérimentés qui se montrent pédagogue. Expérimenter l'adhésion à des communautés en ligne, assistez à des conférences et rejoindre des groupes d'utilisateurs sont tout autant de moyens d'acquérir un soutien positif. Ensemble, vous pourrez partager vos connaissances, agrandir votre réseau profesionnel et ainsi, atteindre de nouveaux sommets en développement.",
  "Dans le monde du développement informatique, il est important de s'entourer de soutien. Recherchez des communautés en ligne, des forums ou des groupes de discussion où vous pouvez interagir avec d'autres professionnels du domaine. Le partage d'expériences, de conseils et de ressources peut vous aider à surmonter les obstacles, à élargir votre réseau professionnel et à rester motivé dans votre carrière de développeur informatique.",

  "La pratique de l'autocompassion est bénéfique pour un développeur informatique. Apprenez à vous traiter avec bienveillance et compréhension lorsque vous faites face à des défis ou à des erreurs. Reconnaître que personne n'est parfait et que les erreurs sont des occasions d'apprentissage vous permettra de développer une attitude positive envers vous-même. Cultiver l'autocompassion vous aidera à faire face aux difficultés avec résilience et ainsi, maintenir une estime de soi saine.",
  "L'autocompassion est une notion essentielle au développeur. Accordez-vous de la compassion lorsque vous faites face à des obstacles ou à des échecs. Soyez juste envers vous-même en apprenant de vos erreurs en étant conscient qu'elles vous feront grandir en tant que professionnel. Cette notion vous permettra aussi de maintenir un équilibre émotionnel sain qu'il faudra garder tout au long de votre parcours informatique.",

  "Affronter les défis avec courage est une compétence cruciale pour un développeur informatique. Soyez prêt à relever des défis techniques, à résoudre des problèmes complexes et à vous adapter aux nouvelles technologies. La résilience et la détermination vous permettront de surmonter les obstacles et d'atteindre des solutions innovantes. N'ayez pas peur d'affronter les défis de front, car c'est dans ces moments que vous grandissez et développez vos compétences en tant que développeur informatique.",
  "Dans le domaine du développement informatique, il est essentiel d'affronter les défis avec courage. Les projets peuvent présenter des difficultés et des obstacles, mais c'est en faisant preuve de persévérance et de détermination que vous pourrez les surmonter. Soyez prêt à sortir de votre zone de confort, à explorer de nouvelles approches et à prendre des décisions audacieuses pour résoudre les problèmes. L'affrontement courageux des défis vous permettra de vous améliorer en tant que développeur informatique.",

  "Apprécier vos réussites est essentiel pour un développeur informatique. Célébrez vos réalisations, qu'elles soient petites ou grandes. Chaque ligne de code fonctionnelle, chaque projet terminé et chaque problème résolu méritent d'être reconnus. Prenez le temps de vous féliciter et de vous récompenser pour vos réussites. Cette appréciation vous permettra de maintenir votre motivation et de cultiver une attitude positive envers votre travail en tant que développeur informatique.",
  "En tant que développeur informatique, il est important d'apprécier vos réussites. Chaque étape accomplie, chaque défi relevé et chaque contribution significative méritent d'être célébrés. Prenez le temps de reconnaître vos accomplissements et de vous féliciter pour vos progrès. Cette appréciation renforcera votre estime de soi, vous donnera confiance en vos capacités et vous inspirera à continuer d'exceller dans votre carrière de développeur informatique.",

  "La curiosité est une qualité essentielle pour un développeur informatique. Cultivez votre soif de connaissances en explorant de nouveaux domaines, en posant des questions et en cherchant constamment à en apprendre davantage. Restez ouvert aux nouvelles idées, aux technologies émergentes et aux meilleures pratiques. La curiosité vous permettra d'élargir votre expertise, de rester à jour avec les avancées de l'industrie et de développer votre créativité en tant que développeur informatique.",
  "Dans le métier de développeur informatique, la curiosité est une qualité précieuse. Soyez avide de connaissances et explorez divers domaines de l'informatique. Posez des questions, effectuez des recherches approfondies et soyez à l'affût des dernières tendances technologiques. La curiosité vous permettra d'approfondir vos compétences techniques, d'innover dans vos projets et de rester passionné par votre métier de développeur informatique.",

  "La résilience est une compétence clé pour un développeur informatique. Dans un tel domaine en constante évolution, vous devez être prêt à faire face aux échecs, aux obstacles et aux périodes de stress. Cultivez votre résilience en développant une attitude positive face aux revers, en apprenant de vos erreurs et en utilisant les défis comme des opportunités d'apprentissage. Une résilience solide vous permettra de persévérer, de vous adapter aux changements et de continuer à progresser en tant que développeur informatique.",
  "La résilience est essentielle pour un développeur informatique. Vous serez confronté à des délais serrés, à des problèmes complexes et à des exigences élevées. Développez votre résilience en cultivant une mentalité positive, en renforçant vos compétences de résolution de problèmes et en apprenant à gérer efficacement le stress. La résilience vous permettra de rester concentré, de surmonter les obstacles et de continuer à exceller dans votre carrière de développeur informatique.",

  "Cultiver votre unicité est essentiel pour chaque développeur. Mettez en valeur vos compétences spécifiques, vos expériences uniques et votre perspective personnelle dans votre travail. Explorez des domaines qui vous passionnent et trouvez des moyens de les intégrer dans vos projets. Ne soyez pas effrayé d'être différent et d'apporter une contribution originale. En cultivant votre unicité, vous vous démarquerez parmi les autres développeurs et vous créerez des opportunités uniques dans votre carrière.",
  "Dans le domaine du développement informatique, il est essentiel de cultiver votre unicité. Identifiez ce qui vous distingue des autres développeurs, que ce soit une compétence spécifique, une approche novatrice ou une expérience unique. Mettez en valeur ces aspects dans votre travail et trouvez des moyens de les intégrer dans vos projets. En embrassant votre unicité, vous apporterez une perspective précieuse à l'équipe et vous créerez une valeur ajoutée dans votre carrière de développeur informatique.",
];


// Récupération des éléments HTML
const typingText = document.querySelector(".typing-text p");
const inpField = document.querySelector(".wrapper .input-field");
const BtnAgain = document.querySelector(".content button");
const timeTag = document.querySelector(".time span b");
const nbErreurs = document.querySelector(".erreur span");
const tauxWPM = document.querySelector(".wpm span");
const tauxCPM = document.querySelector(".cpm span");

let popUp = document.querySelector("#popup");
const BtnFermer = document.querySelector(".content-btn");

// Déclarations de variables
let timer;
let maxTime = 60;
let timeLeft = maxTime;
let charI = 0;
let erreurs = 0;
let isTyping = 0;

function loadParagraph() {
  const randI = Math.floor(Math.random() * paragraphs.length);
  typingText.innerHTML = "";
  paragraphs[randI].split("").forEach((char) => {
    console.log(char);
    let span = `<span>${char}</span>`;
    typingText.innerHTML += span;
  });
  typingText.querySelectorAll("span")[0].classList.add("active");
  document.addEventListener("keydown", () => inpField.focus());
  typingText.addEventListener("click", () => inpField.focus());
}

function initTyping() {
  let characters = typingText.querySelectorAll("span");
  let typedChar = inpField.value.split("")[charI];
  if (charI < characters.length - 1 && timeLeft > 0) {
    if (!isTyping) {
      timer = setInterval(initTimer, 1000);
      isTyping = true;
    }
    if (typedChar == null) {
      if (charI > 0) {
        charI--;
        if (characters[charI].classList.contains("incorrect")) {
          erreurs--;
        }
        characters[charI].classList.remove("correct", "incorrect");
      }
    } else {
      if (characters[charI].innerText == typedChar) {
        characters[charI].classList.add("correct");
      } else {
        erreurs++;
        characters[charI].classList.add("incorrect");
      }
      charI++;
    }
    characters.forEach((span) => span.classList.remove("active"));
    characters[charI].classList.add("active");

    let wpm = Math.round(((charI - erreurs) / 5 / (maxTime - timeLeft)) * 60);
    wpm = wpm < 0 || !wpm || wpm === Infinity ? 0 : wpm;

    tauxWPM.innerText = wpm;
    nbErreurs.innerText = erreurs;
    tauxCPM.innerText = charI - erreurs;
  } else {
    clearInterval(timer);
    inpField.value = "";
  }
}

function scorePopUp() {
  if (timeLeft === 0) {
    let textPopUp = document.querySelector(".popup-text");
    /* affichage de la performance (taux réalisés) */

    textPopUp.innerHTML =
      "Tu as effectué une performance de " +
      tauxWPM.textContent +
      " mots par minute soit " +
      tauxCPM.textContent +
      " caractères par minute";

    // commentPopUp();
    popUp.style.display = "block";
  }
}

// function commentPopUp() {
//   // variable contenant un conseil selon le score
//   let conseil = "";

//   if (tauxWPM.textContent <= 10) {
//     conseil =
//       "Persévère. Plus le chemin est long, plus la récompense est belle.";
//   } else if (tauxWPM.textContent < 20) {
//     conseil = "Tu peux encore mieux faire, continue, on tient quelque chose...";
//   } else if (tauxWPM.textContent < 30) {
//     conseil =
//       "Ne te contente pas du minimum sachant le potentiel que tu viens juste de démontrer. Persévère.";
//   } else if (tauxWPM.textContent < 35) {
//     conseil = "Le niveau est bon, c'est plus que correct.";
//   } else if (tauxWPM.textContent < 40) {
//     conseil = "Le niveau est très bon, voire presque excellent.";
//   } else if (tauxWPM.textContent < 50) {
//     conseil = "Félicitations, tu es l'excellence.";
//   } else if (tauxWPM.textContent >= 50) {
//     conseil = "Félicitations, tu es l'excellence.";
//   }

//   if (conseil !== "") {
//     textPopUp.innerHTML += "<br><br><u><b>Conseil :</b></u> " + conseil;
//   }
// }

function hidingPopUp() {
  popUp.style.display = "none";
}

function initTimer() {
  if (timeLeft > 0) {
    timeLeft--;
    timeTag.innerText = timeLeft;
    let wpm = Math.round(((charI - erreurs) / 5 / (maxTime - timeLeft)) * 60);
    tauxWPM.innerText = wpm;
  } else {
    scorePopUp();
    clearInterval(timer);
  }
}

function resetGame() {
  loadParagraph();
  clearInterval(timer);
  timeLeft = maxTime;
  charI = erreurs = isTyping = 0;
  inpField.value = "";
  timeTag.innerText = timeLeft;
  tauxWPM.innerText = 0;
  nbErreurs.innerText = 0;
  tauxCPM.innerText = 0;
}

loadParagraph();
// scorePopUp();
inpField.addEventListener("input", initTyping);
BtnAgain.addEventListener("click", resetGame);
BtnFermer.addEventListener("click", hidingPopUp);
