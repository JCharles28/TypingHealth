const paragraphs = [
  "Pour réussir en tant que développeur informatique, il est essentiel de surmonter la peur de l'échec. Apprenez à voir les échecs comme des opportunités d'apprentissage, de croissance et d'amélioration. Chaque échec est une occasion de vous améliorer et de développer vos compétences techniques pour devenir un développeur informatique plus fort et plus confiant."
  ,"Dans le domaine du développement informatique, surmonter la peur de l'échec est essentiel. Acceptez que l'échec fait partie intégrante du processus d'apprentissage et de développement professionnel. Ne laissez pas la peur vous empêcher d'explorer de nouvelles idées, de prendre des risques et de repousser vos limites. En embrassant les échecs comme des occasions d'apprentissage, vous pouvez progresser en tant que développeur informatique et atteindre de nouveaux sommets."
  
  ,"La peur de l'échec peut paralyser votre progression en tant que développeur informatique. Apprenez à l'apprivoiser en vous concentrant sur le processus plutôt que sur le résultat final. Concentrez-vous sur l'apprentissage, l'expérience et le développement de vos compétences plutôt que sur le jugement extérieur. En adoptant cette mentalité, vous pourrez surmonter la peur de l'échec et vous épanouir en tant que développeur informatique."
  ,"En tant que développeur informatique, il est crucial de surmonter la peur de l'échec. Ne laissez pas la peur vous empêcher de prendre des risques, d'explorer de nouvelles approches ou d'innover. Apprenez à voir l'échec comme une étape vers le succès et une occasion d'apprendre et de grandir. En surmontant votre peur de l'échec, vous pourrez réaliser votre plein potentiel en tant que développeur informatique."
  
  ,"La confiance en soi est essentielle pour surmonter la peur de l'échec en tant que développeur informatique. Croyez en vos compétences, en votre capacité à résoudre des problèmes et à atteindre vos objectifs. Cultivez une mentalité positive et faites preuve d'auto-compassion lorsque vous faites face à des revers. En renforçant votre confiance en vous, vous pourrez surmonter la peur de l'échec et réaliser de grandes réalisations en tant que développeur informatique."
  ,"Pour surmonter la peur de l'échec en tant que développeur informatique, il est important de renforcer votre confiance en vous. Faites preuve d'auto-compassion et de gratitude pour vos accomplissements, même les plus petits. Développez une mentalité positive et apprenez à vous concentrer sur vos forces et vos compétences. En cultivant votre confiance en vous, vous pourrez surmonter les obstacles et atteindre vos objectifs en tant que développeur informatique."
  
  ,"L'apprentissage continu est la clé pour surmonter la peur de l'échec en tant que développeur informatique. Investissez du temps dans l'acquisition de nouvelles compétences, l'exploration de nouvelles technologies et l'expérimentation de projets personnels. Plus vous développez vos connaissances et votre expertise, plus vous serez confiant dans vos capacités à relever les défis et à surmonter les échecs. L'apprentissage continu vous permettra de surmonter la peur de l'échec et de vous épanouir en tant que développeur informatique."
  ,"En tant que développeur informatique, l'apprentissage continu est essentiel pour surmonter la peur de l'échec. Restez curieux, explorez de nouvelles technologies et suivez les tendances de l'industrie. Soyez ouvert aux retours et aux critiques constructives, et utilisez-les comme des occasions d'apprendre et de vous améliorer. L'apprentissage continu renforcera votre confiance en vous et vous aidera à surmonter la peur de l'échec en tant que développeur informatique."
  
  ,"La persévérance est cruciale pour surmonter la peur de l'échec en tant que développeur informatique. Ne vous découragez pas face aux obstacles ou aux revers. Faites preuve de détermination et de résilience, et continuez à avancer malgré les difficultés. Chaque échec est une occasion d'apprendre et de grandir. En restant persévérant, vous pouvez surmonter la peur de l'échec et atteindre vos objectifs en tant que développeur informatique."
  ,"Pour surmonter la peur de l'échec en tant que développeur informatique, la persévérance est essentielle. Ne laissez pas les échecs vous décourager. Restez motivé, fixez-vous des objectifs réalisables et prenez des mesures concrètes pour les atteindre. En faisant preuve de persévérance, vous pourrez surmonter les obstacles et transformer les échecs en succès en tant que développeur informatique."
  
  ,"S'entourer de soutien est important pour surmonter la peur de l'échec en tant que développeur informatique. Cherchez des mentors, des collègues et des communautés en ligne qui vous soutiennent et vous encouragent. Partagez vos expériences, vos défis et vos succès avec d'autres développeurs. Ensemble, vous pouvez surmonter la peur de l'échec et vous soutenir mutuellement dans votre parcours en tant que développeur informatique."
  ,"En tant que développeur informatique, s'entourer de soutien est essentiel pour surmonter la peur de l'échec. Rejoignez des groupes d'utilisateurs, participez à des communautés en ligne et établissez des liens avec d'autres professionnels du domaine. Entourez-vous de personnes bienveillantes qui vous soutiennent, vous inspirent et vous encouragent à poursuivre vos objectifs. Le soutien des autres peut vous aider à surmonter la peur de l'échec et à atteindre le succès en tant que développeur informatique."
  
  ,"La prise de risques est nécessaire pour surmonter la peur de l'échec en tant que développeur informatique. Ne vous contentez pas de rester dans votre zone de confort, mais plutôt explorez de nouvelles technologies, essayez de nouveaux langages de programmation et lancez-vous dans des projets ambitieux. Acceptez que l'échec fait partie du processus d'apprentissage et utilisez-le comme une occasion de grandir et de vous améliorer. La prise de risques vous permettra de surmonter la peur de l'échec et de progresser en tant que développeur informatique."
  ,"Surmonter la peur de l'échec en tant que développeur informatique nécessite de prendre des risques. Sortez de votre zone de confort, participez à des projets audacieux et expérimentez de nouvelles approches. Acceptez que l'échec fait partie intégrante du processus d'apprentissage et utilisez-le comme une occasion d'amélioration. La prise de risques vous aidera à surmonter la peur de l'échec et à atteindre de nouveaux sommets en tant que développeur informatique."
  
  ,"La confiance en soi est fondamentale pour surmonter la peur de l'échec en tant que développeur informatique. Croyez en vos compétences, en votre expertise et en votre capacité à résoudre les problèmes. Travaillez sur votre estime de soi en mettant en valeur vos réussites passées et en vous rappelant vos forces. La confiance en soi vous aidera à surmonter la peur de l'échec et à vous sentir plus à l'aise dans votre carrière de développeur informatique."
  ,"Pour surmonter la peur de l'échec en tant que développeur informatique, il est essentiel de cultiver la confiance en soi. Croyez en vos compétences et en votre capacité à relever les défis. Rappeler-vous vos réalisations passées et les obstacles que vous avez déjà surmontés. En cultivant la confiance en soi, vous pourrez surmonter la peur de l'échec et atteindre de nouveaux niveaux de succès en tant que développeur informatique."
  ];

// Récupération des éléments HTML
const typingText = document.querySelector(".typing-text p");
const inpField = document.querySelector(".wrapper .input-field");
const BtnAgain = document.querySelector(".content button");
const timeTag = document.querySelector(".time span b");
const nbErreurs = document.querySelector(".erreur span");
const tauxWPM = document.querySelector(".wpm span");
const tauxCPM = document.querySelector(".cpm span");

let popUp = document.querySelector(".popup");
const BtnFermer = document.querySelector(".content-btn");

// Déclarations de variables
let timer;
let maxTime = 60;
let timeLeft = maxTime;
let charI = 0;
let erreurs = 0;
let isTyping = 0;

function loadParagraph() {
  const randI = Math.floor(Math.random() * paragraphs.length);
  typingText.innerHTML = "";
  paragraphs[randI].split("").forEach((char) => {
    console.log(char);
    let span = `<span>${char}</span>`;
    typingText.innerHTML += span;
  });
  typingText.querySelectorAll("span")[0].classList.add("active");
  document.addEventListener("keydown", () => inpField.focus());
  typingText.addEventListener("click", () => inpField.focus());
}

function initTyping() {
  let characters = typingText.querySelectorAll("span");
  let typedChar = inpField.value.split("")[charI];
  if (charI < characters.length - 1 && timeLeft > 0) {
    if (!isTyping) {
      timer = setInterval(initTimer, 1000);
      isTyping = true;
    }
    if (typedChar == null) {
      if (charI > 0) {
        charI--;
        if (characters[charI].classList.contains("incorrect")) {
          erreurs--;
        }
        characters[charI].classList.remove("correct", "incorrect");
      }
    } else {
      if (characters[charI].innerText == typedChar) {
        characters[charI].classList.add("correct");
      } else {
        erreurs++;
        characters[charI].classList.add("incorrect");
      }
      charI++;
    }
    characters.forEach((span) => span.classList.remove("active"));
    characters[charI].classList.add("active");

    let wpm = Math.round(((charI - erreurs) / 5 / (maxTime - timeLeft)) * 60);
    wpm = wpm < 0 || !wpm || wpm === Infinity ? 0 : wpm;

    tauxWPM.innerText = wpm;
    nbErreurs.innerText = erreurs;
    tauxCPM.innerText = charI - erreurs;
  } else {
    clearInterval(timer);
    inpField.value = "";
  }
}

function initTimer() {
  if (timeLeft > 0) {
    timeLeft--;
    timeTag.innerText = timeLeft;
    let wpm = Math.round(((charI - erreurs) / 5 / (maxTime - timeLeft)) * 60);
    tauxWPM.innerText = wpm;
  } else {
    clearInterval(timer);
  }
}

function resetGame() {
  loadParagraph();
  clearInterval(timer);
  timeLeft = maxTime;
  charI = erreurs = isTyping = 0;
  inpField.value = "";
  timeTag.innerText = timeLeft;
  tauxWPM.innerText = 0;
  nbErreurs.innerText = 0;
  tauxCPM.innerText = 0;
}

function scorePopUp() {
  let text = document.getElementById("popup-text");
  if (timeLeft == 0) {
    /* affichage de la pop-up */
    popUp.style.display = "block";

    /* affichage de la performance (taux réalisés) */
    text.innerHTML +=
      "Tu as effectué une performance de " +
      tauxWPM.textContent +
      " mots par minute soit " +
      tauxCPM.textContent +
      " caractères par minute";
  }
}

// $(window).load(function () {
//   $(".loading").css(
//     {
//       "opacity" : "0",
//       "transition" : "opacity 0.6s ease-in-out"
//     }
//   )
// });
loadParagraph();
scorePopUp();
inpField.addEventListener("input", initTyping);
BtnAgain.addEventListener("click", resetGame);
BtnFermer.addEventListener("click", () => {
  popUp.style.display = "none";
});
